<ul>

  <li ng-repeat="node in nodeCtrl.nodes" class="node">

    <div class="dialogbox">
      <div class="body"> <span ng-class="{'tip tip-right': node.depth == 0, 
                                          'tip tip-up': node.depth > 0}"></span>
        <div class="message">
          <p dir="ltr">
            <i style="font-size: 10px">{{node.createdAt}}</i> <mark>(by: {{node.username}})</mark> 
          </p>

          <p style="word-wrap: break-word;white-space: pre-line">
            <strong>{{ node.content }}</strong>
            <hr class="contentDelim">
          </p>

          <div style="background-color: #D08C8C;" class="btn btn-xs" ng-if="node.sub_arguments.length > 0" 
           ng-click="toggleNode(node)">
            <span ng-class="{'glyphicon glyphicon-chevron-up': node.expanded, 
                             'glyphicon glyphicon-chevron-down':!node.expanded && node.sub_arguments}" aria-hidden="true">
            </span>
          </div>

          <div style="background-color: #DEB4B4;" class="btn btn-xs" ng-click="nodeCtrl.newReplyPressed(node)">
            הגב
            <span class="glyphicon glyphicon-pencil" aria-hidden="true">
            </span>
          </div>
          
          <div ng-show="node.replyPressed">
            <hr>
            <textarea class="form-control text-right" rows="3" placeholder="רשום כאן" ng-model="nodeCtrl.replyText" style="width:100%; margin: 5px; background-color: #DADAE5"></textarea>
            <button type="submit" class="btn btn-primary btn-xs" style="" ng-click="nodeCtrl.submitNewReply(node)">סיים</button>
            <button type="submit" class="btn btn-default btn-xs" ng-click="nodeCtrl.cancelReply(node)">בטל</button>
          </div>
          
        </div>
      </div>
    </div>

    <treenode ng-if="node.sub_arguments" nodes='node.sub_arguments' tree="tree" options="options" ng-show="node.expanded" id="{{node._id}}"></treenode>

  </li>

</ul>